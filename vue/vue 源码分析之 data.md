#  vue æºç åˆ†æ

## é¢˜è®°
 è¿™æ˜¯ vue æºç åˆ†æçš„ç¬¬ä¸€èŠ‚ï¼Œå­¦ä¹  vue æœ‰æ¥è¿‘ä¸¤å¹´æ—¶é—´äº†ï¼Œå…¥æ‰‹çš„ç¬¬ä¸€ä»½å·¥ä½œï¼Œå°±æ˜¯ä» vue å¼€å§‹ï¼Œæœ¬ç€è‡ªæˆ‘é©±åŠ¨èƒ½åŠ›ï¼Œæ¸¡äººæ¸¡å·±ã€‚ç°åœ¨åˆ†æä¸€ä¸‹vueæºç ã€‚ç»„é‡Œè€å¤§ç»å¸¸è¯´ä¸ç®¡åšä»€ä¹ˆäº‹å…ˆæƒ³æ¸…æ¥šï¼Œå“ªæ€•ä½ ä¸€å¤©åªåšä¸€ä»¶äº‹ä¹Ÿå¥½ï¼Œæ‰€ä»¥æ–‡ç« å¯èƒ½å‡ºçš„æ¯”è¾ƒæ…¢ï¼Œæ•¬è¯·è€å¿ƒç­‰å¾…ã€‚æœ¬ç³»åˆ—é‡‡ç”¨å‘¨æ›´å½¢å¼ï¼Œæ¯å‘¨ä¸‰å‡†æ—¶å‘è½¦ã€‚
åˆ†æè¯¾ä¼šæŒ‰ç…§ä»¥ä¸‹å¤§çº²æ¥ï¼š æ¯å‘¨ä¸€ç¯‡çš„å½¢å¼ï¼ˆç®—æ˜¯ç«‹äº†ä¸ª flag å—ğŸ˜‚ï¼‰ã€‚

[TOC]

      â”œâ”€â”€ vue.extend
      â”œâ”€â”€ vue.nextTick
      â”œâ”€â”€ vue.set
      â”œâ”€â”€ vue.delete
      â”œâ”€â”€ vue.directive
      â”œâ”€â”€ vue.filter
      â”œâ”€â”€ vue.use
      â”œâ”€â”€ vue.mixin
      â”œâ”€â”€ vue.compile
      â”œâ”€â”€ vue.observable   
      â”œâ”€â”€ vue.version
      â”œâ”€â”€ [data](#data)
      â”œâ”€â”€ [props](#props)
      â”œâ”€â”€ propsData  
      â”œâ”€â”€ [computed](#computed)  
      â”œâ”€â”€ methods
      â””â”€â”€ watch



## åŒå‘ç»‘å®š
å®ç°åŒå‘ç»‘å®šçš„æ–¹å¼æœ‰å¾ˆå¤šã€‚
### [data](#data)

 ç›‘å¬è€…ï¼ˆobserverï¼‰: å¯¹æ•°æ®å¢åŠ  getter  å’Œ  setterï¼Œä»¥åŠå¾€è§‚å¯Ÿè€…åˆ—è¡¨ä¸­å¢åŠ è§‚å¯Ÿè€…ï¼Œå½“æ•°æ®å˜åŠ¨æ—¶å»é€šçŸ¥è§‚å¯Ÿè€…åˆ—è¡¨ã€‚
  è§‚å¯Ÿè€…åˆ—è¡¨(Dep): è¿™ä¸ªæ¨¡å—çš„ä¸»è¦ä½œç”¨æ˜¯ç»´æŠ¤ä¸€ä¸ªå±æ€§çš„è§‚å¯Ÿè€…åˆ—è¡¨ï¼Œå½“è¿™ä¸ªå±æ€§è§¦å‘getteræ—¶å°†è§‚å¯Ÿè€…æ·»åŠ åˆ°åˆ—è¡¨ä¸­ï¼Œå½“å±æ€§è§¦å‘setteré€ æˆæ•°æ®å˜åŒ–æ—¶é€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€…ï¼Œ
  è§‚å¯Ÿè€…ï¼ˆwatchï¼‰ï¼šè¿™ä¸ªå¯¹æ•°æ®è¿›è¡Œè§‚å¯Ÿï¼Œä¸€æ—¦æ”¶åˆ°æ•°æ®å˜åŒ–çš„é€šçŸ¥å°±ä¼šå»æ”¹å˜è§†å›¾.
```js









```
## [props](#props)

```js





```


## [computed](#computed)



```js




```


ä¸ºä»€ä¹ˆdataå¿…é¡»æ˜¯å‡½æ•°å‘¢

new çš„æ—¶å€™ï¼Œ å®ƒé¦–å…ˆéœ€è¦åˆ›å»ºä¸€ä¸ªä¸ªç»„ä»¶æ„é€ å™¨ï¼Œç„¶åæ³¨å†Œç»„ä»¶ã€‚æ³¨å†Œç»„ä»¶çš„æœ¬è´¨å…¶å®å°±æ˜¯å»ºç«‹ä¸€ä¸ªç»„ä»¶æ„é€ å™¨çš„å¼•ç”¨ã€‚ä½¿ç”¨ç»„ä»¶æ‰æ˜¯çœŸæ­£åˆ›å»ºä¸€ä¸ªç»„ä»¶å®ä¾‹ã€‚æ‰€ä»¥ï¼Œæ³¨å†Œç»„ä»¶å…¶å®å¹¶ä¸äº§ç”Ÿæ–°çš„ç»„ä»¶ç±»ï¼Œä½†ä¼šäº§ç”Ÿä¸€ä¸ªå¯ä»¥ç”¨æ¥å®ä¾‹åŒ–çš„æ–°æ–¹å¼ã€‚

ç†è§£è¿™ç‚¹åï¼Œ åœ¨ç†è§£ js çš„åŸå‹é“¾

```js
var MyComponent = function() {}
MyComponent.prototype.data = {
  a: 1,
  b: 2,
}
// ä¸Šé¢æ˜¯ä¸€ä¸ªè™šæ‹Ÿçš„ç»„ä»¶æ„é€ å™¨ï¼ŒçœŸå®çš„ç»„ä»¶æ„é€ å™¨æ–¹æ³•å¾ˆå¤š

var component1 = new MyComponent()
var component2 = new MyComponent()
// ä¸Šé¢å®ä¾‹åŒ–å‡ºæ¥ä¸¤ä¸ªç»„ä»¶å®ä¾‹ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡<my-component>è°ƒç”¨ï¼Œåˆ›å»ºçš„ä¸¤ä¸ªå®ä¾‹

component1.data.a === component2.data.a // true
component1.data.b = 5
component2.data.b // 5


```

å¦‚æœä¸¤ä¸ªå®åŠ›åŒæ—¶å¼•ç”¨åŒä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆå½“ä½ ä¿®æ”¹å…¶ä¸­ä¸€ä¸ªå±æ€§çš„æ—¶å€™ï¼Œ å¦å¤–ä¸€ä¸ªå®åŠ›ä¹Ÿä¼šè·Ÿç€æ”¹ã€‚

```js
var MyComponent = function() {
  this.data = this.data()
}
MyComponent.prototype.data = function() {
  return {
    a: 1,
    b: 2,
  }
}
```

Vue-ç»„ä»¶çš„dataå±æ€§ä¸ºä»€ä¹ˆå¿…é¡»æ˜¯å‡½æ•°ï¼Ÿ
by axiu
2019å¹´07æœˆ13æ—¥
å†™ä»£ç 
 1
ä¸€èˆ¬åœ¨å…¬å¸ç¯å¢ƒä½¿ç”¨ä¸­ï¼Œå„ç§å‰ç«¯æ¡†æ¶éƒ½ä¼šç”¨ä¸€ä¸‹ï¼Œå› ä¸ºä¸åŒæ¡†æ¶ç†å¿µå’Œä½¿ç”¨åœºæ™¯æœ‰äº›è®¸åŒºåˆ«ï¼Œæœ‰çš„é‡è§„æ¨¡åŒ–ï¼Œæœ‰çš„è¿½æ±‚è½»ä¾¿æ˜“ä¸Šæ‰‹ï¼›æœ‰çš„æ¨¡å—åŒ–ç¨‹åº¦å¾ˆé«˜ï¼Œæœ‰çš„é€šå¸¸å…¨éƒ¨å†™ä¸€èµ·ï¼›æœ‰çš„è§„åˆ™å®‰æ’çš„æ˜æ˜ç™½ç™½ï¼Œæœ‰çš„åˆéœ€è¦å„ç§è¯­æ³•ç³–â€¦â€¦è™½ç„¶æœ€è¿‘å‡ ä¸ªæœˆå·¥ä½œç‰¹åˆ«å¿™ï¼Œä½†æ˜¯è¿˜æ˜¯æ‹¿å‡ºäº†ä¸€ç‚¹ç‚¹æ—¶é—´æ¥æ‰©å……ä¸€ä¸‹Vueçš„èƒŒæ™¯çŸ¥è¯†ã€‚

ä¸ºä»€ä¹ˆç»„ä»¶çš„dataå±æ€§å¿…é¡»æ˜¯å‡½æ•°ï¼Ÿ
åœ¨è‡ªå®šä¹‰æ¨¡å—çš„æ–°æ‰‹ä¸Šè·¯éƒ¨åˆ†ï¼ŒVueæ–‡æ¡£æ˜¯è¿™ä¹ˆå†™çš„

é€šè¿‡ Vue æ„é€ å™¨ä¼ å…¥çš„å„ç§é€‰é¡¹å¤§å¤šæ•°éƒ½å¯ä»¥åœ¨ç»„ä»¶é‡Œç”¨ã€‚data æ˜¯ä¸€ä¸ªä¾‹å¤–ï¼Œå®ƒå¿…é¡»æ˜¯å‡½æ•°ã€‚å¦‚æœå®šä¹‰äº†ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆ Vue ä¼šåœæ­¢ï¼Œå¹¶åœ¨æ§åˆ¶å°å‘å‡ºè­¦å‘Šï¼Œå‘Šè¯‰ä½ åœ¨ç»„ä»¶ä¸­ data å¿…é¡»æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚


æœ‰ä¸€ç‚¹è§‰å¾—å¾ˆå¥‡æ€ªï¼Œæ˜æ˜new Vue()çš„æ—¶å€™ï¼Œdataæ˜¯å¯ä»¥ä¼ å…¥ä¸€ä¸ªå¯¹è±¡çš„ï¼Œä¸ºä»€ä¹ˆåœ¨ç»„ä»¶è¿™é‡Œï¼Œdataå°±å¿…é¡»ä¸ºå‡½æ•°äº†å‘¢ï¼Ÿ

ç®€è€Œè¨€ä¹‹ï¼Œç»„ä»¶çš„é…ç½®ï¼ˆoptionsï¼‰å’Œå®ä¾‹ï¼ˆinstanceï¼‰æ˜¯éœ€è¦åˆ†å¼€çš„ã€‚æœ€æ ¹æœ¬åŸå› æ˜¯jså¯¹äºå¯¹è±¡ï¼ˆä»¥åŠæ•°ç»„ç­‰ï¼‰æ˜¯ä¼ å¼•ç”¨çš„ï¼Œå› ä¸ºå¦‚æœç›´æ¥å†™ä¸€ä¸ªå¯¹è±¡è¿›å»ï¼Œé‚£ä¹ˆå½“ä¾æ­¤é…ç½®åˆå§‹åŒ–äº†å¤šä¸ªå®ä¾‹ä¹‹åï¼Œè¿™ä¸ªå¯¹è±¡å¿…å®šæ˜¯å¤šä¸ªå®ä¾‹å…±äº«çš„ã€‚

ä¸¾ä¸¤ä¸ªä¾‹å­å°±æ˜ç™½äº†

ä¾‹å­1
```js
config = {
  data: {
    name: 'foo'
  }
};
 
function someComponent (config) {
  this.data = config.data;
}
 
let c1 = new someComponent(config);
 
let c2 = new someComponent(config);
 
c1.data.name = 'bar';
console.log(c2.data.name); // 'bar'
```
ä¾‹å­2

```js
config = {
  data: function () {
    return {
      name: 'foo'
    };
  }
};
 
function someComponent (config) {
  this.data = config.data();
}
 
let c1 = new someComponent(config);
 
let c2 = new someComponent(config);
 
c1.data.name = 'bar';
 
console.log(c2.data.name); // 'foo'
```
ä¸ºäº†åŠ æ·±å°è±¡ï¼Œè¿˜æ˜¯æŠŠç›¸å…³éƒ¨åˆ†éƒ½æ‰¯ä¸€ç‚¹ã€‚

ç»„ä»¶ï¼ˆComponentï¼‰å®šä¹‰æ–¹å¼
å†™å®Œhello worldçš„åŒå­¦éƒ½çŸ¥é“ï¼Œç»„ä»¶åœ¨å®šä¹‰çš„æ—¶å€™ï¼Œå¯ä»¥å…¨å±€ï¼ˆVue.component()ï¼‰æˆ–è€…å±€éƒ¨æ³¨å†Œ

```js
new Vue({
  // ...
  components: {
    // <my-component> å°†åªåœ¨çˆ¶æ¨¡æ¿å¯ç”¨
    'my-component': Child
  }
})
```
ä¸¤ç§æ–¹æ³•å¹¶æ²¡æœ‰æœ¬è´¨åŒºåˆ«ï¼Œéƒ½éœ€è¦åœ¨dataå±æ€§é‡Œä¼ å…¥å¯¹è±¡ã€‚å±€éƒ¨æ³¨å†Œåªæ˜¯æ”¾åœ¨äº†new Vueçš„optionså¤„ç†éƒ¨åˆ†ï¼Œä»ç„¶æ˜¯Vue.extend(definition)é‡Œåˆ¤æ–­ã€‚

ä¸‹é¢ä»¥å…¨å±€æ³¨å†Œä¸ºä¾‹è¿‡ä¸€éVueæºç ã€‚

å‰é¢è¯´çš„æŠ¥é”™ä½ç½®åœ¨è¿™é‡Œ

```js
strats.data // vue-template-compiler/build.js
...
if (typeof childVal !== 'function') {
    "development" !== 'production' && warn(
      'The "data" option should be a function ' +
      'that returns a per-instance value in component ' +
      'definitions.',
      vm
    )
    return parentVal
}
...
```
è¿™ä¸ªå‡½æ•°ç®€å•æ¥è¯´ï¼Œæ˜¯è´Ÿè´£dataå­—æ®µå†…å®¹å¤„ç†çš„ï¼Œä¸ç®¡æ˜¯new Vueçš„å‚æ•°é‡Œdataè¿˜æ˜¯ç»„ä»¶åˆå§‹åŒ–çš„dataï¼Œéƒ½è¦ç»è¿‡è¿™é‡Œã€‚

ç®€å•èµ·è§ï¼Œä»è¿™ä¸ªä½ç½®å¾€ä¸Šå€’ï¼ˆäºŒå£°ï¼‰åˆ°å¼€å¤´ï¼š

```js
initGlobalAPI (Vue)
-function initAssetRegisters (Vue)
...
åˆ°è¿™ä¸€æ­¥ç»“æŸï¼ŒæŒ‰ç…§_assetTypesï¼ˆåŒ…æ‹¬'component','directive','filter'ï¼‰æŒ‚è½½æ–¹æ³•ã€‚è¿™é‡ŒæŒ‚è½½äº†Vue.componentçš„åˆå§‹åŒ–æ–¹æ³•ï¼Œä½†è¿˜æ²¡è°ƒç”¨ã€‚

ç»è¿‡ä¸€ä¼—å…¶ä»–å†…éƒ¨æ“ä½œã€‚ç›´åˆ°æ‰§è¡Œæˆ‘ä»¬çš„ä»£ç ï¼ˆç»„ä»¶æ˜¯ä»å®˜æ–¹æ–‡æ¡£æŠ„è¿‡æ¥çš„ï¼‰

```

```js
Vue.component('button-counter', {
  data: function () {
    return {
      counter: 0
    }
  }
  template: '<button v-on:click="count++">You clicked me {{ count }} times.</button>'
})
 
-Vue.extend(definition)
definitionå†…å®¹ï¼š

```
{
  data: function () {...},
  "template": "<button v-on:click=\"count++\">You clicked me {{ count }} times.</button>",
  "name": "button-counter"
}
å†™å…¥ç»„ä»¶çš„é…ç½®ï¼š

```js
Sub.options = mergeOptions(Super.options,  definition)
-mergeField('data')
-strats.data
```
è¿™ä¸€æ­¥å°±æ˜¯å‰é¢æŠ¥é”™çš„é‚£ä¸€æ­¥ï¼Œä¼šåˆ¤æ–­dataæ˜¯å¦ä¸ºå‡½æ•°ï¼Œæ˜¯åˆ™æ‰§è¡Œå¹¶æŒ‚è½½å‡½æ•°æ–¹æ³•ã€‚å¦åˆ™è¿”å›çˆ¶çº§å±æ€§ã€‚

vue-component-config

ç»„ä»¶æŒ‚è½½ç»“æœ
çœ‹èµ·æ¥3ä¸ª_assetTypesåŠ äº†sï¼Œæ˜¯åœ¨ä»£ç é‡Œæçš„

```js
config._assetTypes.forEach(function (type) {
  strats[type + 's'] = mergeAssets
})
åœ¨å®é™…ä½¿ç”¨æ—¶ï¼Œæ‰ä¼šåˆå§‹åŒ–ç»„ä»¶ï¼Œå³è°ƒç”¨

```

```js
function VueComponent (options) {
      this._init(options)
}
```
## åˆå§‹åŒ–Vueå®ä¾‹æ—¶çš„å¤„ç†

new Vueçš„æ—¶å€™ï¼Œä¹Ÿä¼šè°ƒç”¨mergeOptionsï¼Œä¸åŒçš„æ˜¯è¿™æ—¶å€™ä¼ å…¥äº†vmå®ä¾‹ã€‚è¿™æ—¶åœ¨mergeField('data')é‡Œèµ°äº†å¦å¤–ä¸€æ¡è·¯çº¿ï¼š

```js
return function mergedInstanceDataFn () {
// ...
    var instanceData = typeof childVal === 'function'
        ? childVal.call(vm)
        : childVal
// ...
```
